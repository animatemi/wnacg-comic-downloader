WNACG漫画下载器
===========================
用`Node.js`写的一个爬虫。只要配置好一些关键词，运行程序后就会从`wnacg`下载关键词相应的漫画。为了不给`wnacg`网站造成负担，在爬虫中加了很多限制。这些限制，有些是可以解除的，像是请求的间隔时间；有些是不可以解除的，像是请求的切换方式，你要是想改这个就只能重写了。
****	
|友情提示|~~小撸怡情，大撸伤身，强撸灰飞烟灭~~
|---|---
|联系方式|animatemi@outlook.com


****
## 目录
* [使用说明](#使用说明)
* [爬虫细节](#爬虫细节)
    * 运行方式
    * ~~好多~~未完成的功能 | 待改进的地方
* [注意事项](#注意事项)

## 使用说明
-----------
1. 安装`Node.js`，初始化项目
2. `wnacg`提供的下载链接大陆需要翻墙才能访问，所以大陆的朋友需要先具备稳定的科学上网工具，这个手段就多种多样了。大家可以各显神通。顺带一提，我是`ssr` + `proxifier`强制`node`程序走`socks5`代理
3. 项目`data`文件夹中维护了一个`setting.json`文件，这个文件长这样

        {
            "keywords": [],
            "savePath": "",
            "domain": "ncg.world",
            "subscription": []
        }

    解释一下这几个配置项

    |key|类型|说明|
    |----|----|----|
    |`keywords`|字符串数组|订阅的关键词，需要手动配置，~~默认为作者推荐~~|
    |`savePath`|字符串|漫画下载路径，默认为默认为D:\本子，如有需要自己更改|
    |`domain`|字符串|wnacg域名，默认有一个，如有需要自己更改|
    |`subscription`|对象数组|更新订阅后根据关键词自动生成，无需配置|

    下面是一个配置样例

        {
            "keywords": [
                "あづま煉",
                "なぱた"
            ],
            "savePath": "D://漫画",
            "domain": "ncg.world",
            "subscription": [
                {
                "keyword": "あづま煉",
                "lastId": 71851,
                "lastTime": "2019-03-07"
                },
                {
                "keyword": "なぱた",
                "lastId": 71851,
                "lastTime": "2019-03-07"
                }
            ]
        }

    配置`setting`文件。首先，要在`keywords`中添加相应的关键词，然后在终端输入`node updateSub.js`，`subscription`下就会生成相应的关键词对象。默认生成的`lastId`为`0`，类型为`number`；默认的`lastTime`为`1970-01-01`，类型为`string`。这两个值的作用是：在对相应的关键词进行搜索时，只把上传日期大于等于`lastTime`，且大于`lastId`的漫画加入下载列表。每次下载完成后，程序会把这两个的值修改成最近一次下载该关键词相应漫画的值，这样可以确保每次运行程序都会接续上一次，不会再下载以前已经下载过的漫画。如果你想控制下载漫画的日期，也可以手动修改这个值。
4. 配置完成后，运行`node main.js`，爬虫会在配置的下载路径中生成一个文件名包含下载时间的文件夹，保存下载的漫画和漫画细节文件`detail.json`（包括漫画的ID，标题，创建时间，分类，页数，标签，备注，上传者等信息）

## 爬虫细节
-----------
### **运行方式**

有时间补充_(:з」∠)_。程序写的还是挺简单的，花点时间看看代码应该就能明白

### **未完成的功能 | 待改进的地方**

- 在`setting`中设置下载的文件名格式功能，还未实现，现在的格式是`[漫画ID]漫画标题`
- `setting`中`keywords`关键词去重，还有下载列表对象数组的去重，这些都没有写
- 异常只做了一部分必要的，所以偶尔程序会崩
- 漫画细节文件`detail.json`的分析报告和根据漫画细节文件下载漫画功能，还未实现
- 还有其他的一些小问题。程序现在还只是可以用的状态。由于作者现在要去找工作，程序的后续改进会在找到工作后进行。

## 注意事项
-----------
- 对关键词对象进行设置时，`lastId`要设置成`number`类型，`lastTime`要设置成`2018-03-04`这种格式，要确保月和日为两位
- 其他的想起来更新